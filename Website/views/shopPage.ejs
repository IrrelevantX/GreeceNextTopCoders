<% include ./partials/header.ejs %>
<link rel="stylesheet" href="/css/shopitem.css">
<link rel="stylesheet" href="/css/index.css">
<style>
        #map {
            height: 400px;
            width: 150%;
        }
        
</style>


 

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Business Frontpage - Start Bootstrap Template</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/business-frontpage.css" rel="stylesheet">

</head>

<body>
    <% include partials/navbar.ejs %>
  <!-- Navigation -->
  

  <!-- Header -->
  <header class="bg-dark py-5 mb-5" >
    <div class="container h-100" >
      <div class="row h-100 align-items-center">
        <div class="col-lg-12">
          <h1 class="display-4 text-white mt-5 mb-2 text-center"><%= shopname%></h1>
          
        </div>
      </div>
    </div>
  </header>

  <!-- Page Content -->
  <div style="background: rgba(255, 255, 255, 0.507);" class="container">

    <div class="row">
      <div class="col-md-8 mb-5" id = map>

      </div>
      
      <div class="col-md-4 mb-5">
        <h2>Επικοινωνία</h2>
        <hr>
        <address>
          <strong>Διεύθυνση :</strong>
          <br>
          <%if ( shopaddress != null){%>
            <%= shopaddress %>
            <% } else { %>
            <%= "Δεν έχει δωθεί" %>
            <%} %>
          <br>
        </address>
        <address>
          <abbr title="Τηλέφονο Επικοινωνίας"> Τηλ:</abbr>
          <%if ( shopphone != null){%>
            <%= shopphone %>
            <% } else { %>
            <%= "Δεν έχει δωθεί" %>
            <%} %>
          <br>
          
        </address>
      </div>
    </div>
    <!-- /.row -->
    <h3 style="background:white; " class= "text-center py-4" >Προϊόντα</h3><br>
    <div class="row">
            <% productofshop.forEach((productofshop, index) => { %>
                <div class="col-md-4 mb-5">
                    <% if (productofshop.productWithdrawn == 1) { %>
                    <p class="m-0 text-center">Το προϊόν ενδέχεται να μην είναι διαθέσιμο</p>
                    <% } %>
                  <div class="card h-100 text-center">
                        <a href="/item/<%=productofshop.productId%>"><img class="card-img-top productImage" src="/assets/productsImg/<%= productofshop.productId%>.png" alt="" onerror="this.onerror=null;this.src='/assets/productsImg/default.png'"></a>
                    <div class="card-body">
                      <h4 class="card-title"><a href="/item/<%=productofshop.productId%>"> <%= productofshop.productName %></a></h4>
                      <h5>Τιμή : <%= productofshop.productPrice%> € </h3>
                      <h5>Κατηγορία : <%=productofshop.productCategory%> </h5>  
                      <% if (productofshop.productDescription != null && productofshop.productDescription != '') { %>
                        <p class="card-text">Περιγραφή: <%= productofshop.productDescription%></p>
                        <% } %>
                      <% if (productofshop.productDateFrom != '0000-00-00' && productofshop.productDateFrom != null && productofshop.productDateTo != '0000-00-00' && productofshop.productDateTo != null ) { %>
                        <p>Διαθέσιμο από: <br> <%=productofshop.productDateFrom.toISOString().substring(0, 10);%> <br>έως: <br> <%= productofshop.productDateTo.toISOString().substring(0, 10);%> </p>
                        <% }else if( productofshop.productDateFrom != '0000-00-00' && productofshop.productDateFrom != null) { %>
                            <p>Διαθέσιμο από: <br> <%=productofshop.productDateFrom.toISOString().substring(0, 10);%></p>
                        <% } else if(productofshop.productDateTo != '0000-00-00' && productofshop.productDateTo != null) { %>
                            <p>Διαθέσιμο έως: <br> <%= productofshop.productDateTo.toISOString().substring(0, 10);%> </p>
                        <% } %>
                  </div>
                    
                  </div>
                </div>
                <% }) %>
    </div>
    <!-- /.row -->

  </div>
  <!-- /.container -->

  <!-- Footer -->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; Student Offers</p>
    </div>
    <!-- /.container -->
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

</body>
<script>
    function initMap() {
        var lang = <%=shoplng%> ;
        var lati = <%=shoplat%> ;
        var zooming;


        var shopmarker;
        if (lati == lang) {
            shopmarker = {
                lat: 37.983810,
                lng: 23.727539
            };
            zooming = 6;
        } else {
            shopmarker = {
                lat: lati,
                lng: lang
            };
            zooming = 15;
        }
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: zooming,
            center: shopmarker
        });
        if (lang != lati)
            var marker = new google.maps.Marker({
                position: shopmarker,
                map: map
            });


    }
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJaiM1gLI2nYRcZO_PukSgLAXS-E0OaoI&callback=initMap">
</script>
</html>
